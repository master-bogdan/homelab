apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: staging-auth
resources:
  - ../../base

  - external-secret.yaml
helmCharts:
  - name: authentik
    repo: https://charts.goauthentik.io
    version: "2025.10.2"
    releaseName: authentik
    namespace: staging-auth
    includeCRDs: true
    valuesFile: values-staging.yaml

patches:
  - target:
      kind: HTTPRoute
      name: http-authentik
    path: httproute-patch.yaml
